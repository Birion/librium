"use strict";

// Generated by CoffeeScript 2.3.1
var ns;

ns = {};

ns.model = function () {
  var $eventPump;
  $eventPump = $("body");
  return {
    init: function init(rtype) {
      var _id = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

      var ajaxOptions;
      ajaxOptions = {
        type: "GET",
        url: _id ? "/api/" + rtype + "/" + _id : "/api/" + rtype,
        accepts: "application/json",
        dataType: "json"
      };
      return $.ajax(ajaxOptions).done(function (data) {
        return $eventPump.trigger("model_init_success", [data, rtype]);
      }).fail(function (xhr, textStatus, errorThrown) {
        return $eventPump.trigger("model_error", [xhr, textStatus, errorThrown]);
      });
    },
    read: function read(rtype) {
      var _id = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

      var ajaxOptions;
      ajaxOptions = {
        type: "GET",
        url: _id ? "/api/" + rtype + "/" + _id : "/api/" + rtype,
        accepts: "application/json",
        dataType: "json"
      };
      return $.ajax(ajaxOptions).done(function (data) {
        return $eventPump.trigger("model_read_success", [data]);
      }).fail(function (xhr, textStatus, errorThrown) {
        return $eventPump.trigger("model_error", [xhr, textStatus, errorThrown]);
      });
    }
  };
}();

ns.view = function () {
  var $dropdown;
  $dropdown = $(".ui.dropdown");
  return {
    updateDropdown: function updateDropdown(vals) {
      return console.log(vals);
    }
  };
}();

ns.controller = function (m, v) {
  var $eventPump, bookID, model, values, view;
  model = m;
  view = v;
  $eventPump = $("body");
  bookID = $("#_id").val();
  values = {};
  setTimeout(function () {
    model.init("book", bookID);
    model.init("authors");
    model.init("formats");
    console.log(values["formats"]);
    return view.updateDropdown(values.formats);
  }, 100);
  $eventPump.on("model_init_success", function (e, data, rtype) {
    return values[rtype] = data;
  });
  $eventPump.on("model_read_success", function (e, data) {
    return console.log(data);
  });
  return $eventPump.on("model_error", function (e, xhr, textStatus, errorThrown) {
    var error_msg;
    error_msg = textStatus + ": " + errorThrown + " - " + xhr.responseJSON.detail;
    //    view.error error_msg
    return console.log(error_msg);
  });
}(ns.model, ns.view);
//# sourceMappingURL=data:application/json;base64,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RixHQUFBO1NBR0EsV0FBQSxFQUFBLENBQUEsYUFBQSxFQUE2QixVQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsVUFBQSxFQUFBLFdBQUEsRUFBQTtBQUMzQixRQUFBLFNBQUE7QUFBQSxnQkFBWSxVQUFaLFVBQVksV0FBWixXQUErQyxJQUFJLFlBQUosQ0FBL0MsTUFBQTs7V0FFQSxRQUFBLEdBQUEsQ0FBQSxTQUFBLEM7QUFIRixHQUFBLEM7QUFyQmMsQ0FBRyxDQUFHLEdBQU4sS0FBRyxFQUFlLEdBQWxCLElBQUcsQ0FBbkIiLCJzb3VyY2VzQ29udGVudCI6WyJucyA9IHt9XG5cbm5zLm1vZGVsID0gZG8gLT5cbiAgJGV2ZW50UHVtcCA9ICQgXCJib2R5XCJcblxuICBpbml0OiAocnR5cGUsIF9pZD1udWxsKSAtPlxuICAgIGFqYXhPcHRpb25zID1cbiAgICAgIHR5cGU6IFwiR0VUXCJcbiAgICAgIHVybDogaWYgX2lkIHRoZW4gXCIvYXBpLyN7cnR5cGV9LyN7X2lkfVwiIGVsc2UgXCIvYXBpLyN7cnR5cGV9XCJcbiAgICAgIGFjY2VwdHM6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgICBkYXRhVHlwZTogXCJqc29uXCJcbiAgICAkLmFqYXggYWpheE9wdGlvbnNcbiAgICAgIC5kb25lIChkYXRhKSAtPlxuICAgICAgICAkZXZlbnRQdW1wLnRyaWdnZXIgXCJtb2RlbF9pbml0X3N1Y2Nlc3NcIiwgW2RhdGEsIHJ0eXBlXVxuICAgICAgLmZhaWwgKHhociwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIC0+XG4gICAgICAgICRldmVudFB1bXAudHJpZ2dlciBcIm1vZGVsX2Vycm9yXCIsIFt4aHIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duXVxuXG4gIHJlYWQ6IChydHlwZSwgX2lkPW51bGwpIC0+XG4gICAgYWpheE9wdGlvbnMgPVxuICAgICAgdHlwZTogXCJHRVRcIlxuICAgICAgdXJsOiBpZiBfaWQgdGhlbiBcIi9hcGkvI3tydHlwZX0vI3tfaWR9XCIgZWxzZSBcIi9hcGkvI3tydHlwZX1cIlxuICAgICAgYWNjZXB0czogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgIGRhdGFUeXBlOiBcImpzb25cIlxuICAgICQuYWpheCBhamF4T3B0aW9uc1xuICAgICAgLmRvbmUgKGRhdGEpIC0+XG4gICAgICAgICRldmVudFB1bXAudHJpZ2dlciBcIm1vZGVsX3JlYWRfc3VjY2Vzc1wiLCBbZGF0YV1cbiAgICAgIC5mYWlsICh4aHIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSAtPlxuICAgICAgICAkZXZlbnRQdW1wLnRyaWdnZXIgXCJtb2RlbF9lcnJvclwiLCBbeGhyLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bl1cblxubnMudmlldyA9IGRvIC0+XG4gICRkcm9wZG93biA9ICQgXCIudWkuZHJvcGRvd25cIlxuXG4gIHVwZGF0ZURyb3Bkb3duOiAodmFscykgLT5cbiAgICBjb25zb2xlLmxvZyB2YWxzXG5cbm5zLmNvbnRyb2xsZXIgPSBkbyAobT1ucy5tb2RlbCwgdj1ucy52aWV3KSAtPlxuICBtb2RlbCA9IG1cbiAgdmlldyA9IHZcbiAgJGV2ZW50UHVtcCA9ICQgXCJib2R5XCJcbiAgYm9va0lEID0gJChcIiNfaWRcIikudmFsKClcbiAgdmFsdWVzID0ge31cblxuICBzZXRUaW1lb3V0IC0+XG4gICAgbW9kZWwuaW5pdCBcImJvb2tcIiwgYm9va0lEXG4gICAgbW9kZWwuaW5pdCBcImF1dGhvcnNcIlxuICAgIG1vZGVsLmluaXQgXCJmb3JtYXRzXCJcbiAgICBjb25zb2xlLmxvZyB2YWx1ZXNbXCJmb3JtYXRzXCJdXG4gICAgdmlldy51cGRhdGVEcm9wZG93biB2YWx1ZXMuZm9ybWF0c1xuICAsIDEwMFxuXG4gICRldmVudFB1bXAub24gXCJtb2RlbF9pbml0X3N1Y2Nlc3NcIiwgKGUsIGRhdGEsIHJ0eXBlKSAtPlxuICAgIHZhbHVlc1tydHlwZV0gPSBkYXRhXG5cbiAgJGV2ZW50UHVtcC5vbiBcIm1vZGVsX3JlYWRfc3VjY2Vzc1wiLCAoZSwgZGF0YSkgLT5cbiAgICBjb25zb2xlLmxvZyBkYXRhXG5cbiAgJGV2ZW50UHVtcC5vbiBcIm1vZGVsX2Vycm9yXCIsIChlLCB4aHIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSAtPlxuICAgIGVycm9yX21zZyA9IFwiI3t0ZXh0U3RhdHVzfTogI3tlcnJvclRocm93bn0gLSAje3hoci5yZXNwb25zZUpTT04uZGV0YWlsfVwiXG4jICAgIHZpZXcuZXJyb3IgZXJyb3JfbXNnXG4gICAgY29uc29sZS5sb2cgZXJyb3JfbXNnXG4iXSwic291cmNlUm9vdCI6Ii4uL2NvZmZlZSJ9
//# sourceURL=/home/ondra/PycharmProjects/librium/librium/static/coffee/book.coffee
//# sourceMappingURL=book.js.map
